<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Utkan | Kanka AI Matematik SerÃ¼veni</title>
    <style>
        :root { --ana: #6c5ce7; --ikinci: #a29bfe; --altin: #fdcb6e; --dark: #2d3436; }
        body { font-family: 'Poppins', sans-serif; background: #dfe6e9; margin: 0; overflow-x: hidden; }
        
        .top-bar { background: var(--ana); color: white; padding: 15px; display: flex; justify-content: space-around; position: sticky; top: 0; z-index: 1000; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .stat-box { background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; font-weight: bold; }

        .container { max-width: 1000px; margin: 20px auto; width: 95%; }

        /* KANKA AI PANEL */
        .ai-panel { background: white; border-radius: 20px; padding: 25px; display: flex; align-items: center; gap: 20px; margin-bottom: 20px; border-bottom: 5px solid var(--ana); }
        .ai-avatar { font-size: 60px; width: 100px; height: 100px; background: #f1f2f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 4px solid var(--altin); transition: 0.5s; }

        /* ANA MENÃœ BUTONLARI */
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
        .action-btn { border: none; padding: 20px; border-radius: 15px; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 16px; box-shadow: 0 4px 0 rgba(0,0,0,0.1); }
        .action-btn:hover { transform: translateY(-3px); filter: brightness(1.1); }

        /* MODAL (MARKET & HÄ°KAYE & SORU) */
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 2000; display: none; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; }
        .modal-content { background: white; border-radius: 20px; padding: 30px; max-width: 600px; width: 100%; max-height: 90vh; overflow-y: auto; text-align: center; }

        /* MARKET SÄ°STEMÄ° */
        .market-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #eee; }
        .price { color: #e17055; font-weight: bold; }

        /* HÄ°KAYE MODU */
        #story-text { line-height: 1.8; font-style: italic; color: var(--dark); }

        .secret-area { margin-top: 20px; padding: 10px; border-top: 2px dashed #ccc; }
        input[type="text"], input[type="number"] { padding: 10px; border-radius: 8px; border: 1px solid #ccc; width: 80%; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="stat-box">ğŸ’° Puan: <span id="puan">0</span></div>
        <div class="stat-box">ğŸ“ˆ Seviye: <span id="seviye">BaÅŸlangÄ±Ã§</span></div>
        <button onclick="openModal('cheat-modal')" style="background:none; border:none; cursor:pointer;">âš™ï¸</button>
    </div>

    <div class="container">
        <div class="ai-panel">
            <div id="ai-face" class="ai-avatar">ğŸ¤–</div>
            <div>
                <h2 style="margin:0;">Kanka AI</h2>
                <p id="ai-chat">Matematik evrenine hoÅŸ geldin Utkan! Buradaki her ÅŸey senin zekanla ÅŸekilleniyor.</p>
            </div>
        </div>

        <div class="menu-grid">
            <button class="action-btn" style="background:#0984e3;" onclick="startMath('rastgele')">ğŸ² Rastgele Soru</button>
            <button class="action-btn" style="background:#00b894;" onclick="openModal('market-modal')">ğŸ›’ Market</button>
            <button class="action-btn" style="background:#6c5ce7;" onclick="startStory()">ğŸ“– Hikaye Modu</button>
            <button class="action-btn" style="background:#d63031;" onclick="resetData()">â™»ï¸ SÄ±fÄ±rla</button>
        </div>
    </div>

    <div id="math-modal" class="overlay">
        <div class="modal-content">
            <h2 id="quest-title">Soru Geliyor...</h2>
            <p id="quest-desc" style="font-size: 24px; font-weight: bold;"></p>
            <input type="number" id="math-input" placeholder="CevabÄ±n?">
            <br><br>
            <button class="action-btn" style="background:#00b894; width:100%" onclick="checkMath()">CEVAPLA</button>
            <button class="action-btn" style="background:#aaa; margin-top:10px;" onclick="closeModal('math-modal')">Kapat</button>
        </div>
    </div>

    <div id="market-modal" class="overlay">
        <div class="modal-content">
            <h2>ğŸ›’ Mega Market</h2>
            <div class="market-item">
                <span>ğŸ›¸ <b>Galaksi KostÃ¼mÃ¼</b></span>
                <span class="price">1500 Puan <button onclick="buy(1500, 'ğŸ›¸')">Al</button></span>
            </div>
            <div class="market-item">
                <span>ğŸ”¥ <b>Alevli Kanka AI</b></span>
                <span class="price">3000 Puan <button onclick="buy(3000, 'ğŸ”¥')">Al</button></span>
            </div>
            <div class="market-item">
                <span>ğŸŒŒ <b>Boyut Gezgini ÃœnvanÄ±</b></span>
                <span class="price">5000 Puan <button onclick="buy(5000, 'ğŸ‘‘')">Al</button></span>
            </div>
            <div class="market-item">
                <span>ğŸ’ <b>SÄ±nÄ±rsÄ±z Zeka Kristali</b></span>
                <span class="price">10000 Puan <button onclick="buy(10000, 'ğŸ’')">Al</button></span>
            </div>
            <button class="action-btn" style="background:#aaa; margin-top:20px;" onclick="closeModal('market-modal')">Kapat</button>
        </div>
    </div>

    <div id="story-modal" class="overlay">
        <div class="modal-content">
            <h2>ğŸ“– Matematik Efsanesi</h2>
            <p id="story-text">YÃ¼kleniyor...</p>
            <button id="story-next" class="action-btn" style="background:var(--ana);" onclick="nextStory()">Devam Et</button>
            <button class="action-btn" style="background:#aaa; margin-top:10px;" onclick="closeModal('story-modal')">MacerayÄ± Bitir</button>
        </div>
    </div>

    <div id="cheat-modal" class="overlay">
        <div class="modal-content">
            <h3>ğŸ”‘ Ã–zel Protokol</h3>
            <input type="text" id="cheat-input" placeholder="Gizli kodu yaz...">
            <br><br>
            <button class="action-btn" style="background:black;" onclick="activateCheat()">Kodu Ã‡alÄ±ÅŸtÄ±r</button>
            <button onclick="closeModal('cheat-modal')" style="display:block; margin: 10px auto; background:none; border:none; color:blue; cursor:pointer;">Ä°ptal</button>
        </div>
    </div>

    <script>
        let score = 0;
        let correctAnswer = 0;
        let storyPart = 0;

        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.lang = 'tr-TR';
            msg.pitch = 0.8; // Daha derin, robotik bir ses
            msg.rate = 1.0;
            window.speechSynthesis.speak(msg);
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function startMath() {
            openModal('math-modal');
            let n1 = Math.floor(Math.random() * 100);
            let n2 = Math.floor(Math.random() * 50);
            correctAnswer = n1 + n2;
            document.getElementById('quest-desc').innerText = `${n1} + ${n2} = ?`;
            speak(`${n1} artÄ± ${n2} iÅŸleminin sonucu nedir Utkan?`);
        }

        function checkMath() {
            let val = parseInt(document.getElementById('math-input').value);
            if(val === correctAnswer) {
                score += 100;
                updateUI();
                speak("MÃ¼kemmel analiz. PuanÄ±n hesabÄ±na aktarÄ±ldÄ±.");
                closeModal('math-modal');
            } else {
                speak("HatalÄ± veri giriÅŸi. Tekrar dene.");
            }
            document.getElementById('math-input').value = "";
        }

        function updateUI() {
            document.getElementById('puan').innerText = score;
            if(score > 2000) document.getElementById('seviye').innerText = "Matematik UzmanÄ±";
            if(score > 5000) document.getElementById('seviye').innerText = "Efsanevi";
        }

        function buy(p, face) {
            if(score >= p) {
                score -= p;
                updateUI();
                document.getElementById('ai-face').innerText = face;
                speak("SatÄ±n alma baÅŸarÄ±lÄ±. Yeni Ã¶zellikler aktif edildi.");
            } else {
                speak("Yetersiz puan. Daha fazla soru Ã§Ã¶zmelisin.");
            }
        }

        // HÄ°KAYE SÄ°STEMÄ°
        const stories = [
            "YÄ±l 2026... DÃ¼nya matematik krizine girdi. SayÄ±lar birbirine karÄ±ÅŸtÄ±.",
            "Utkan isminde bir dahi, Kanka AI'yÄ± uyandÄ±rdÄ±.",
            "GÃ¶revin: TÃ¼m iÅŸlemleri doÄŸru Ã§Ã¶zerek sayÄ±larÄ± eski dÃ¼zenine kavuÅŸturmak.",
            "Marketten aldÄ±ÄŸÄ±n her ekipman seni daha gÃ¼Ã§lÃ¼ yapacak. HazÄ±r mÄ±sÄ±n?"
        ];

        function startStory() {
            storyPart = 0;
            openModal('story-modal');
            nextStory();
        }

        function nextStory() {
            if(storyPart < stories.length) {
                document.getElementById('story-text').innerText = stories[storyPart];
                speak(stories[storyPart]);
                storyPart++;
            } else {
                document.getElementById('story-text').innerText = "Macera baÅŸlÄ±yor! Åimdi menÃ¼den soru Ã§Ã¶zmeye git.";
                document.getElementById('story-next').classList.add('hidden');
            }
        }

        // HÄ°LE SÄ°STEMÄ°
        function activateCheat() {
            let code = document.getElementById('cheat-input').value;
            if(code === "sonsuz para") {
                score = 999999;
                updateUI();
                speak("Hile protokolÃ¼ aktif. SÄ±nÄ±rsÄ±z puan yÃ¼klendi.");
                closeModal('cheat-modal');
            } else {
                speak("HatalÄ± kod.");
            }
        }

        function resetData() {
            score = 0;
            updateUI();
            document.getElementById('ai-face').innerText = "ğŸ¤–";
            speak("Sistem sÄ±fÄ±rlandÄ±.");
        }
    </script>
</body>
</html>
