<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS V40 | Utkan Sancak Edition</title>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    <style>
        :root { --p: #2563eb; --s: #10b981; --d: #0f172a; --r: #f85149; --b: #161b22; }
        body { margin: 0; background: var(--d); color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        
        /* ğŸ†” GiriÅŸ EkranÄ± */
        #login-screen { position: fixed; inset: 0; background: radial-gradient(circle, #1e293b 0%, #0a0c10 100%); z-index: 10000; display: flex; align-items: center; justify-content: center; }
        .card { background: var(--b); padding: 30px; border-radius: 25px; border: 1px solid #30363d; text-align: center; width: 85%; max-width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        input, select { padding: 15px; border-radius: 12px; border: 1px solid #30363d; background: #0d1117; color: white; width: 90%; margin: 10px 0; outline: none; }
        
        /* Sayfalar */
        .page { display: none; width: 100%; height: 100vh; padding: 20px; box-sizing: border-box; overflow-y: auto; padding-bottom: 100px; }
        
        /* Profil Header */
        .profile-header { background: linear-gradient(45deg, #1e293b, #0f172a); padding: 25px; border-radius: 20px; border: 1px solid var(--p); margin-bottom: 20px; text-align: center; }
        .id-badge { background: var(--p); color: white; padding: 5px 15px; border-radius: 50px; font-weight: bold; font-size: 14px; display: inline-block; margin-top: 10px; cursor: pointer; }

        /* ModÃ¼ller */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .btn-mod { background: var(--b); color: white; border: 1px solid #334155; padding: 20px; border-radius: 15px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-mod:hover { border-color: var(--p); background: #1e293b; }

        /* Matematik Kutusu */
        #math-box { display: none; background: var(--b); padding: 20px; border-radius: 20px; border: 2px solid var(--s); margin-bottom: 20px; }

        /* Alt Navigasyon */
        .nav { position: fixed; bottom: 0; width: 100%; height: 75px; background: #161b22; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #334155; z-index: 1000; }
        .nav-item { cursor: pointer; text-align: center; font-size: 12px; color: #8b949e; flex: 1; }

        /* CanlÄ± YayÄ±n EkranÄ± */
        #live-overlay { position: fixed; inset: 0; background: #000; z-index: 100000; display: none; flex-direction: column; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="card">
            <h1 style="margin:0; color:var(--p);">NEXUS V40</h1>
            <p style="color:#8b949e; font-size:14px;">Sunucu BaÄŸlantÄ±sÄ± HazÄ±r</p>
            <input type="text" id="user-in" placeholder="AdÄ±nÄ±z ve SoyadÄ±nÄ±z" maxlength="20">
            <button onclick="login()" style="width:100%; padding:15px; background:var(--s); color:white; border:none; border-radius:12px; font-weight:bold; cursor:pointer; margin-top:10px;">GÄ°RÄ°Å YAP</button>
        </div>
    </div>

    <div id="home-page" class="page" style="display:block;">
        <div class="profile-header">
            <div style="font-size: 40px;">ğŸ¦¾</div>
            <h2 id="p-name" style="margin:5px 0;">Misafir</h2>
            <div class="id-badge" id="p-id" onclick="copyMyID()">ID: OluÅŸturuluyor...</div>
            <p style="margin:10px 0 0 0; font-size:14px; color:var(--s);">IQ SEVÄ°YESÄ°: <span id="p-iq">120</span></p>
        </div>

        <div id="math-box">
            <h3 id="math-title" style="margin:0 0 10px 0; color:var(--s);">Soru Panelini AÃ§tÄ±n</h3>
            <p id="math-q" style="font-size:22px; margin:15px 0;"></p>
            <input type="number" id="math-ans" placeholder="Cevap?" style="width:80%;">
            <br>
            <button onclick="checkMath()" style="background:var(--s); border:none; padding:10px 20px; border-radius:10px; color:white; font-weight:bold;">KONTROL ET</button>
            <button onclick="closeMath()" style="background:var(--r); border:none; padding:10px 20px; border-radius:10px; color:white; margin-left:10px;">KAPAT</button>
        </div>

        <div class="grid">
            <button class="btn-mod" onclick="openMath()">â• Matematik Ã‡Ã¶z</button>
            <button class="btn-mod" onclick="showPage('social-page')">ğŸ‘¥ ArkadaÅŸlar</button>
            <button class="btn-mod" onclick="startBroadcast()" style="grid-column: span 2; border-color: var(--r); color: var(--r);">ğŸ“¡ CANLI YAYIN BAÅLAT</button>
        </div>
    </div>

    <div id="social-page" class="page">
        <h2>ğŸ‘¥ ArkadaÅŸlarÄ±m</h2>
        <div id="friends-list">
            <p style="color:#8b949e; text-align:center;">HenÃ¼z arkadaÅŸÄ±n yok. ID ile ekle!</p>
        </div>
        <button onclick="addFriend()" style="width:100%; padding:15px; background:var(--p); color:white; border:none; border-radius:12px; font-weight:bold; margin-top:20px;">+ YENÄ° ARKADAÅ EKLE</button>
    </div>

    <div id="live-overlay">
        <div style="background:#1e293b; padding:15px; display:flex; justify-content:space-between; align-items:center;">
            <span id="live-status-text" style="color:var(--s); font-weight:bold;">â— CANLI YAYIN MODU</span>
            <button onclick="endBroadcast()" style="background:var(--r); color:white; border:none; padding:8px 15px; border-radius:8px;">AyrÄ±l</button>
        </div>
        <iframe id="live-frame" src="" allow="camera; microphone; fullscreen; display-capture; autoplay" style="flex:1; border:none;"></iframe>
    </div>

    <div class="nav">
        <div class="nav-item" onclick="showPage('home-page')">ğŸ <br>Profil</div>
        <div class="nav-item" onclick="showPage('social-page')">ğŸ‘¥<br>Sosyal</div>
        <div class="nav-item" onclick="alert('Nexus Kurucusu: Utkan Sancak\nSÃ¼rÃ¼m: V40 Sunucu Modu')">ğŸ›¡ï¸<br>Admin</div>
    </div>

    <script>
        // --- FIREBASE AYARLARI ---
        const firebaseConfig = {
            apiKey: "AIzaSyDYsWcFVJhvmeorcea8x2Biw1GpHjQuXFY",
            authDomain: "nexus-ai-bc26b.firebaseapp.com",
            projectId: "nexus-ai-bc26b",
            storageBucket: "nexus-ai-bc26b.firebasestorage.app",
            messagingSenderId: "122857450705",
            appId: "1:122857450705:web:61ca30f3e1513c1859a9f0",
            databaseURL: "https://nexus-ai-bc26b-default-rtdb.europe-west1.firebasedatabase.app/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let myData = { name: "", id: "", iq: 120 };
        let currentMathAns = 0;

        // --- GÄ°RÄ°Å FONKSÄ°YONU ---
        function login() {
            const nameInput = document.getElementById('user-in').value;
            if(nameInput.length < 2) return alert("LÃ¼tfen geÃ§erli bir isim gir!");
            
            myData.name = nameInput;
            myData.id = "NXS-" + Math.floor(1000 + Math.random() * 9000);
            
            // Firebase'e Kaydet
            db.ref('users/' + myData.id).set(myData);
            
            document.getElementById('p-name').innerText = myData.name;
            document.getElementById('p-id').innerText = "ID: " + myData.id;
            document.getElementById('login-screen').style.display = 'none';
            
            listenForBroadcasts(); // Bildirimleri dinlemeye baÅŸla
        }

        // --- SAYFA GEÃ‡Ä°ÅLERÄ° ---
        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
            document.getElementById(id).style.display = 'block';
        }

        // --- MATEMATÄ°K SÄ°STEMÄ° (HatasÄ±z) ---
        function openMath() {
            document.getElementById('math-box').style.display = 'block';
            generateQuestion();
        }

        function generateQuestion() {
            let n1 = Math.floor(Math.random() * 50) + 1;
            let n2 = Math.floor(Math.random() * 50) + 1;
            currentMathAns = n1 + n2;
            document.getElementById('math-q').innerText = `${n1} + ${n2} iÅŸleminin sonucu nedir?`;
        }

        function checkMath() {
            const ans = document.getElementById('math-ans').value;
            if(ans == currentMathAns) {
                alert("ğŸ‰ DOÄRU! +5 IQ kazandÄ±n.");
                myData.iq += 5;
                document.getElementById('p-iq').innerText = myData.iq;
                document.getElementById('math-ans').value = "";
                generateQuestion();
            } else {
                alert("âŒ HatalÄ± cevap. Tekrar dene!");
            }
        }

        function closeMath() { document.getElementById('math-box').style.display = 'none'; }

        // --- ARKADAÅLIK SÄ°STEMÄ° ---
        function addFriend() {
            const fid = prompt("ArkadaÅŸÄ±nÄ±n ID'sini gir (Ã–rn: NXS-1234):");
            if(!fid) return;

            db.ref('users/' + fid).once('value', (s) => {
                if(s.exists()) {
                    const friend = s.val();
                    const list = document.getElementById('friends-list');
                    if(list.innerHTML.includes('HenÃ¼z')) list.innerHTML = "";
                    list.innerHTML += `<div style="background:var(--b); padding:15px; border-radius:15px; margin-bottom:10px; border:1px solid #30363d;">ğŸ‘¤ ${friend.name} (${fid}) <span style="color:var(--s); float:right;">â— Aktif</span></div>`;
                    alert(friend.name + " eklendi!");
                } else {
                    alert("ğŸš¨ Bu ID'ye sahip biri bulunamadÄ±!");
                }
            });
        }

        // --- CANLI YAYIN VE BÄ°LDÄ°RÄ°M SÄ°STEMÄ° ---
        function startBroadcast() {
            const roomID = "Nexus_Room_" + myData.id;
            db.ref('broadcast').set({
                sender: myData.name,
                url: "https://meet.jit.si/" + roomID,
                active: true,
                time: Date.now()
            });
            openLiveUI("https://meet.jit.si/" + roomID);
        }

        function listenForBroadcasts() {
            db.ref('broadcast').on('value', (snap) => {
                const data = snap.val();
                if(data && data.active && data.sender !== myData.name) {
                    const join = confirm(`ğŸš¨ BÄ°LDÄ°RÄ°M: ${data.sender} canlÄ± yayÄ±n baÅŸlattÄ±! KatÄ±lmak ister misin?`);
                    if(join) openLiveUI(data.url);
                }
            });
        }

        function openLiveUI(url) {
            document.getElementById('live-frame').src = url;
            document.getElementById('live-overlay').style.display = 'flex';
        }

        function endBroadcast() {
            document.getElementById('live-overlay').style.display = 'none';
            document.getElementById('live-frame').src = "";
            db.ref('broadcast').update({ active: false });
        }

        function copyMyID() {
            navigator.clipboard.writeText(myData.id);
            alert("ID KopyalandÄ±: " + myData.id);
        }
    </script>
</body>
</html>
