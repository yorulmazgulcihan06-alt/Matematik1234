<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Cyber-Utkan Ultimate Fix</title>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Share Tech Mono', monospace; }
        canvas { width: 100vw; height: 100vh; transform: scaleX(-1); position: absolute; top: 0; left: 0; }
        
        /* HUD PANELÄ° - HÄ°Ã‡ GÄ°TMEYEN SABÄ°T PANEL */
        #hud { 
            position: absolute; top: 30px; right: 30px; 
            background: rgba(0, 40, 0, 0.85); padding: 25px; 
            border: 2px solid #0f0; box-shadow: 0 0 20px #0f0; 
            z-index: 999; width: 220px; color: #0f0;
        }
        .stat-box { margin-bottom: 20px; border-bottom: 1px solid #030; }
        .label { font-size: 11px; color: #0a0; text-transform: uppercase; letter-spacing: 2px; }
        .value { font-size: 26px; font-weight: bold; padding: 5px 0; }

        /* MOD BUTONLARI */
        #controls { position: absolute; top: 30px; left: 30px; z-index: 1000; display: flex; gap: 10px; }
        .btn { background: #000; color: #0f0; border: 1px solid #0f0; padding: 12px 20px; cursor: pointer; font-weight: bold; }
        .active { background: #0f0; color: #000; }

        /* EL HAREKETÄ° - ALT ORTA SÄ°YAH BANT */
        #gest-box { 
            position: absolute; bottom: 50px; left: 50%; 
            transform: translateX(-50%); font-size: 38px; color: #0f0;
            background: rgba(0,0,0,0.8); padding: 15px 40px; 
            border: 1px solid #0f0; border-radius: 10px; z-index: 1000;
            min-width: 300px; text-align: center;
        }
    </style>
</head>
<body>
    <div id="controls">
        <button id="n-btn" class="btn active" onclick="setM('normal')">NORMAL</button>
        <button id="g-btn" class="btn" onclick="setM('night')">GECE GÃ–RÃœÅžÃœ</button>
    </div>

    <div id="hud">
        <div class="stat-box">
            <div class="label">KÄ°MLÄ°K:</div>
            <div id="user-val" class="value">UTKAN_MASTER</div>
        </div>
        <div class="stat-box">
            <div class="label">TAHMÄ°NÄ° YAÅž:</div>
            <div id="age-val" class="value">TaranÄ±yor...</div>
        </div>
        <div class="stat-box">
            <div class="label">DENGE ANALÄ°ZÄ°:</div>
            <div id="bal-val" class="value">Stabil</div>
        </div>
    </div>

    <div id="gest-box">SÄ°STEM HAZIR</div>

    <canvas id="out"></canvas>
    <video id="vid" style="display:none"></video>

    <script>
        const video = document.getElementById('vid');
        const canvas = document.getElementById('out');
        const ctx = canvas.getContext('2d');
        let m = 'normal';

        function setM(mode) {
            m = mode;
            document.getElementById('n-btn').className = mode === 'normal' ? 'btn active' : 'btn';
            document.getElementById('g-btn').className = mode === 'night' ? 'btn active' : 'btn';
        }

        function onResults(res) {
            canvas.width = 1280; canvas.height = 720;
            ctx.save();
            
            // GECE GÃ–RÃœÅžÃœ AYARI
            if(m === 'night') ctx.filter = "brightness(1.8) contrast(1.6) hue-rotate(85deg) saturate(0.5)";
            ctx.drawImage(res.image, 0, 0, canvas.width, canvas.height);
            ctx.filter = "none";

            if (res.poseLandmarks) {
                // 1. YAÅž TAHMÄ°NÄ° (OMUZ GENÄ°ÅžLÄ°ÄžÄ°NE GÃ–RE)
                const sW = Math.hypot(res.poseLandmarks[11].x - res.poseLandmarks[12].x, res.poseLandmarks[11].y - res.poseLandmarks[12].y);
                const bH = Math.hypot(res.poseLandmarks[0].x - res.poseLandmarks[28].x, res.poseLandmarks[0].y - res.poseLandmarks[28].y);
                const calcAge = Math.round((sW/bH) * 135 - 3);
                if(calcAge > 5) document.getElementById('age-val').innerText = calcAge;

                // 2. DENGE KONTROLÃœ
                const balance = Math.abs(res.poseLandmarks[23].x - res.poseLandmarks[27].x);
                document.getElementById('bal-val').innerText = balance < 0.12 ? "MÃ¼kemmel" : "Dengesiz";

                // 3. Ã‡UBUK ADAM (STICKMAN) Ã‡Ä°ZÄ°MÄ°
                drawConnectors(ctx, res.poseLandmarks, POSE_CONNECTIONS, {color: '#0f0', lineWidth: 5});
                drawLandmarks(ctx, res.poseLandmarks, {color: '#fff', lineWidth: 2, radius: 2});
            }

            // 4. EL HAREKETÄ° (10 FARKLI MOD)
            if (res.rightHandLandmarks) {
                const mk = res.rightHandLandmarks;
                let f = [mk[4].x < mk[3].x ? 1 : 0];
                [8,12,16,20].forEach(t => f.push(mk[t].y < mk[t-2].y ? 1 : 0));
                const code = f.join('');
                
                const moves = {
                    "11111": "ðŸ›¡ï¸ KALKAN MODU", "01000": "ðŸŽ¯ LAZER KÄ°LÄ°DÄ°", "01100": "âœŒï¸ ZAFER ONAYI",
                    "00000": "ðŸ‘¤ GÄ°ZLÄ° OPERASYON", "10001": "ðŸ•¸ï¸ Ã–RÃœMCEK AÄžI", "11000": "ðŸ”¥ ALEV TOPU",
                    "01110": "ðŸŒŠ SU DALGASI", "00100": "âš¡ ÅžÄ°MÅžEK Ã‡AKMASI", "00001": "ðŸƒ RÃœZGAR BIÃ‡AÄžI", "11110": "ðŸ‹ï¸ AÄžIR GÃœÃ‡"
                };
                if(moves[code]) {
                    document.getElementById('gest-box').innerText = moves[code];
                    document.getElementById('gest-box').style.color = "#0f0";
                }
                drawConnectors(ctx, mk, HAND_CONNECTIONS, {color: '#0ff', lineWidth: 3});
            }

            ctx.restore();
        }

        const h = new Holistic({locateFile: (f) => `https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${f}`});
        h.setOptions({ modelComplexity: 0, smoothLandmarks: true, minDetectionConfidence: 0.5 });
        h.onResults(onResults);
        new Camera(video, {onFrame: async () => await h.send({image: video}), width: 1280, height: 720}).start();
    </script>
</body>
</html>
