<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEXUS INFINITY | MATEMATİK DERSİ</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --interact: #ffca2c; --bg: #050505; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: white; overflow: hidden; position: fixed; width: 100%; height: 100%; }

        /* OYUN SAHNESİ */
        #stage { 
            width: 100vw; height: 100vh; 
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://images.unsplash.com/photo-1509062522246-3755977927d7?w=1200') center/cover;
            position: relative; display: none;
        }

        /* MURAT HOCA VE OYUNCU */
        #player { width: 30px; height: 30px; position: absolute; top: 75%; left: 50%; border-radius: 50%; background: var(--neon); box-shadow: 0 0 15px var(--neon); z-index: 10; }
        .entity { position: absolute; display: flex; flex-direction: column; align-items: center; }
        #murat-hoca { top: 25%; left: 45%; }
        #murat-hoca img { height: 250px; filter: drop-shadow(0 0 10px black); }

        /* ETKİLEŞİM BUTONU */
        #interact-btn {
            position: fixed; bottom: 150px; right: 50px; width: 100px; height: 100px;
            background: var(--interact); border-radius: 50%; border: 5px solid white;
            color: black; font-weight: 900; display: none; align-items: center; justify-content: center;
            box-shadow: 0 0 30px var(--interact); z-index: 1000; cursor: pointer;
        }

        /* TAHTA VE KLAVYE GİRİŞİ */
        #blackboard {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            z-index: 5000; flex-direction: column; align-items: center; justify-content: center;
        }
        .board-content {
            width: 80%; max-width: 600px; background: #064e3b; border: 15px solid #451a03;
            border-radius: 10px; padding: 40px; text-align: center; box-shadow: 0 0 50px black;
        }
        .chalk-text { font-family: 'Orbitron'; font-size: 1.5rem; margin-bottom: 30px; color: white; }
        #answer-input {
            width: 100%; padding: 15px; font-size: 2rem; text-align: center;
            background: transparent; border: none; border-bottom: 4px dashed white;
            color: var(--neon); outline: none; font-family: 'Orbitron';
        }

        /* JOYSTICK */
        #joy-base { position: absolute; bottom: 40px; left: 40px; width: 120px; height: 120px; background: rgba(255,255,255,0.1); border-radius: 50%; border: 2px solid var(--neon); }
        #joy-stick { position: absolute; top: 35px; left: 35px; width: 50px; height: 50px; background: var(--neon); border-radius: 50%; }

        #start-screen { position: fixed; inset: 0; background: #000; z-index: 9000; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="start-screen">
    <button style="padding: 20px 40px; background: var(--neon); border: none; font-weight: 900; border-radius: 10px;" onclick="Game.start()">DERSE GİR (MURAT HOCA)</button>
</div>

<div id="stage">
    <div id="murat-hoca" class="entity">
        <div style="background: rgba(0,0,0,0.7); padding: 5px 10px; border-radius: 5px; margin-bottom: 5px;">Murat Hoca (Matematik)</div>
        <img src="https://www.pngarts.com/files/1/Cartoon-Teacher-Transparent-Background-PNG.png">
    </div>

    <div id="player"></div>

    <div id="joy-base"><div id="joy-stick"></div></div>

    <div id="interact-btn" onclick="Game.openBoard()">TAHTAYA KALK</div>

    <div id="blackboard">
        <div class="board-content">
            <p style="color: #ffca2c; margin-bottom: 10px;">MURAT HOCA SORUYOR:</p>
            <div class="chalk-text" id="question-text">800.000 + 45.000 = ?</div>
            <input type="number" id="answer-input" placeholder="Cevabı yaz..." autocomplete="off">
            <button onclick="Game.checkAnswer()" style="margin-top: 30px; padding: 10px 30px; background: white; color: black; font-weight: 900; border: none; cursor: pointer;">CEVAPLA</button>
            <p style="margin-top: 20px; font-size: 0.8rem; color: #ccc;">(Klavyeden Enter'a basabilirsin)</p>
        </div>
    </div>
</div>

<script>
const Game = {
    px: window.innerWidth / 2, py: window.innerHeight * 0.7,
    jx: 0, jy: 0,
    currentQuestion: 0,
    questions: [
        { q: "450.000 / 1000 kaçtır?", a: "450" },
        { q: "5'in karesi (5²) kaçtır?", a: "25" },
        { q: "En küçük geniş açı kaç derecedir?", a: "91" },
        { q: "1.000.000 - 1 kaçtır?", a: "999999" }
    ],

    start() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('stage').style.display = 'block';
        this.initJoystick();
        this.loop();
        
        // Enter tuşu desteği
        document.getElementById('answer-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') this.checkAnswer();
        });
    },

    initJoystick() {
        const base = document.getElementById('joy-base'), stick = document.getElementById('joy-stick');
        let active = false;
        const handle = (e) => {
            if (!active) return;
            const t = e.touches ? e.touches[0] : e;
            const r = base.getBoundingClientRect();
            let dx = t.clientX - (r.left + 60), dy = t.clientY - (r.top + 60);
            const d = Math.sqrt(dx*dx + dy*dy);
            if (d > 40) { dx *= 40/d; dy *= 40/d; }
            stick.style.transform = `translate(${dx}px, ${dy}px)`;
            this.jx = dx/40; this.jy = dy/40;
        };
        base.addEventListener('touchstart', () => active = true);
        window.addEventListener('touchmove', handle);
        window.addEventListener('touchend', () => { active = false; stick.style.transform = ''; this.jx = 0; this.jy = 0; });
        // PC
        base.addEventListener('mousedown', () => active = true);
        window.addEventListener('mousemove', handle);
        window.addEventListener('mouseup', () => { active = false; stick.style.transform = ''; this.jx = 0; this.jy = 0; });
    },

    loop() {
        this.px += this.jx * 6; this.py += this.jy * 6;
        this.px = Math.max(20, Math.min(window.innerWidth-20, this.px));
        this.py = Math.max(window.innerHeight*0.3, Math.min(window.innerHeight-20, this.py));
        
        const p = document.getElementById('player');
        p.style.left = this.px + 'px'; p.style.top = this.py + 'px';

        // Yakınlık Kontrolü
        const hoca = document.getElementById('murat-hoca').getBoundingClientRect();
        const dist = Math.hypot(this.px - (hoca.left + 50), this.py - (hoca.top + 125));
        document.getElementById('interact-btn').style.display = dist < 120 ? 'flex' : 'none';

        requestAnimationFrame(() => this.loop());
    },

    openBoard() {
        const q = this.questions[this.currentQuestion];
        document.getElementById('question-text').innerText = q.q;
        document.getElementById('blackboard').style.display = 'flex';
        const input = document.getElementById('answer-input');
        input.value = '';
        setTimeout(() => input.focus(), 100); // Klavyeyi tetiklemek için odakla
    },

    checkAnswer() {
        const userAns = document.getElementById('answer-input').value;
        const correctAns = this.questions[this.currentQuestion].a;

        if (userAns === correctAns) {
            alert("MURAT HOCA: Aferin Utkan! Doğru cevap.");
            this.currentQuestion = (this.currentQuestion + 1) % this.questions.length;
        } else {
            alert("MURAT HOCA: Yanlış! " + correctAns + " olmalıydı. Yerine geç!");
        }
        document.getElementById('blackboard').style.display = 'none';
    }
};
</script>
</body>
</html>
